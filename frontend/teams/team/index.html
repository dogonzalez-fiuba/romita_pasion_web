<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name ="viewport" content="width=device-width">
    <link rel="stylesheet" href="../../css/players.css">
    <title>Copa America Web</title>
</head>
<body>
    <section class="home">
        <header class="navbar">
            <div class="box">
                <img class="fondo" src="https://github.com/dogonzalez-fiuba/romita_pasion_web/blob/testing/frontend/players_page/fondoplayers.png?raw=true" />
            </div>
            <div class="mainbox">
                <div class="menu"><div class="rectangle"></div></div>
                <div class="image">
                    <img class="logo" src="https://github.com/dogonzalez-fiuba/romita_pasion_web/blob/testing/frontend/img/logocopa.png?raw=true">
                <div class="text-wrapper-14">
                    <a id="remove_t" type="button" href="/teams" class="link" onclick="remove_team()">REMOVE</a>
                </div>
                <div class="text-wrapper-15">
                    <a class="link" href="/teams">TEAMS</a>
                </div>
                <div class="text-wrapper-16">
                    <a class="link" href="/">HOME</a>
                </div>
                <div class="text-wrapper-17">
                    <a id="edit_t" type="button" class="link">EDIT</a>
                </div>
                <img class="menu-close" src="https://github.com/dogonzalez-fiuba/romita_pasion_web/blob/testing/frontend/img/Variant3.png?raw=true" />
            </div>    
        </header>

        <div class="nombrequipo">
            <div class="equipo"><p id="nombre_equipo"></p></div>
        </div>

        <div class="tarjeta" id="players">
            <div class="Rectangle12 boton">
                <a id="formadd"><img class="botonclick" src="https://github.com/dogonzalez-fiuba/romita_pasion_web/blob/testing/frontend/players_page/addplayers.png?raw=true"></a>
            </div>
        </div>



        <div class="footer">
            <div class="Rectangle8"></div>
            <div class="Copyright2024">Copyright © 2024 Todos los derechos reservados - CONMEBOL Copa América</div>
        </div> 
    </section>
    



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-<correct_hash>" crossorigin="anonymous"></script>



    <script>
        function remove_team(){
            let params = window.location.search
            let id = new URLSearchParams(params).get("id")
            const confirmation = confirm("Are you sure to eliminate this team?")
            if(!confirmation){
                return;
            } 
            fetch("http://localhost:5000/teams/team/"+id,{
                method: 'DELETE'
            }).then(res => {
                if(!res.ok){
                    console.log('Problem')
                    return;
                }
                return res.json()
            })
            .then(data => {
                console.log('Success')
            })
            .catch(error => {
                console.log(error)
            })
        }

        function response_received(response) {
            console.log(response)
            return response.json()
        }
            
        function parse_data(content){
            console.log(content.name)
            const edit = document.getElementById("edit_t")
            edit.setAttribute("href", `/teams/team/edit/?id=${id}`)

 
            const add = document.getElementById("formadd")
            add.setAttribute("href", `/teams/team/add_player?id=${content.id}`)

            const nombre = document.getElementById("nombre_equipo")
            nombre.innerText = content.name
            
            const container = document.getElementById("players")

            for (let index = 0; index < (content.players).length; index++){
                const div = document.createElement("div")
                div.setAttribute("class","Rectangle12")

                const carta = document.createElement("a")
                carta.setAttribute("href", `/teams/team/player?id=${content.players[index].id}`)

                const fondo = document.createElement("img")
                fondo.setAttribute("class", "fondojug")
                fondo.setAttribute("src", "https://github.com/dogonzalez-fiuba/romita_pasion_web/blob/testing/frontend/players_page/fondojugador.png?raw=true")

                const nombre = document.createElement("div")
                nombre.setAttribute("class", "nombrejug")
                nombre.innerText = content.players[index].name

                const posicion = document.createElement("div")
                posicion.setAttribute("class", "position")
                posicion.innerText = content.players[index].position

                const imagen = document.createElement("img")
                imagen.setAttribute("class", "fotojugador")
                imagen.setAttribute("src", content.players[index].img)

                posicion.append(imagen)
                nombre.append(posicion)
                div.append(fondo)
                div.append(nombre)
                carta.append(div)
                container.append(carta)




            }


        }


            let params = window.location.search
            let id = new URLSearchParams(params).get("id")

            fetch("http://localhost:5000/teams/team/"+id)
            .then(response_received)
            .then(parse_data)
            .catch(request_error)
    </script>
</body>


<footer class="bg-dark text-white text-center p-3 mt-4">
    <p>&copy; 2024 Copa America</p>
</footer>